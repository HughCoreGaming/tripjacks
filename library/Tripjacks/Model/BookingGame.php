<?php

/**
 * Tripjacks_Model_BookingGame
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    ##PACKAGE##
 * @subpackage ##SUBPACKAGE##
 * @author     ##NAME## <##EMAIL##>
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class Tripjacks_Model_BookingGame extends Tripjacks_Model_BaseBookingGame {

    public function getvenueGameDate($vid) {
        $q = Doctrine_Query::create()
                ->from('Tripjacks_Model_BookingGame bg')
                ->where('bg.venueid = ?', $vid)
                ->addWhere('bg.played = ?', 'No')
                ->addWhere('bg.type = ?', 'venue')
                ->addWhere('bg.date >= ?', date('Y-m-d'))
                ->orderBy('date', 'DESC LIMIT 12');

        $result = $q->fetchArray();
        return $result;
    }

    public function getType($bgid) {
        $q = Doctrine_Query::create()
                ->addSelect('type as type')
                ->from('Tripjacks_Model_BookingGame bg')
                ->where('bg.booking_gameid = ?', $bgid);
        $result = $q->fetchArray();
        return $result[0]['type'];
    }

    public function getskirmishGameDate($vid) {
        $q = Doctrine_Query::create()
                ->from('Tripjacks_Model_BookingGame bg')
                ->where('bg.venueid = ?', $vid)
                ->addWhere('bg.played = ?', 'No')
                ->addWhere('bg.type = ?', 'skirmish')
                ->addWhere('bg.date >= ?', date('Y-m-d'))
                ->orderBy('date', 'DESC LIMIT 4');
        $result = $q->fetchArray();
        return $result;
    }

    public function dateExists($vid, $date) {
        $q = Doctrine_Query::create()
                ->from('Tripjacks_Model_BookingGame bg')
                ->where('bg.date = ?', $date)
                ->addWhere('bg.venueid = ?', $vid);
        $result = count($q->fetchArray());
        return $result;
    }

    public function get_season_from_id($id) {
        $q = Doctrine_Query::create()
                ->select('season as season')
                ->from('Tripjacks_Model_BookingGame bg')
                ->where('bg.booking_gameid = ?', $id);
        $result = $q->fetchArray();
        return $result[0]['season'];
    }

    public function get_date($id) {
        $q = Doctrine_Query::create()
                ->select('date as date')
                ->from('Tripjacks_Model_BookingGame bg')
                ->where('bg.booking_gameid = ?', $id);
        $result = $q->fetchArray();
        return $result[0]['date'];
    }

}